<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SIH 2025 Problem Statements — Shivang Advanced Viewer</title>

<!-- Bootswatch + icons + TomSelect -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.2.3/morph/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.bootstrap5.min.css" rel="stylesheet">

<style>
  body{background:linear-gradient(135deg,#0f172a,#1e1b4b);color:#f1f5f9;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;padding:20px}
  .header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
  .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,#7c3aed,#ec4899);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px;color:white;box-shadow:0 8px 25px rgba(124,58,237,.3)}
  .title h1{margin:0;font-size:22px} .title p{margin:0;color:#94a3b8;font-size:14px}
  .controls{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:20px}
  #grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:16px}
  .card{background:rgba(255,255,255,.05);backdrop-filter:blur(10px);border-radius:14px;padding:16px;border:1px solid rgba(255,255,255,.08);transition:.25s}
  .card:hover{transform:translateY(-6px);box-shadow:0 12px 28px rgba(0,0,0,.45)}
  .card .title{font-weight:700;font-size:16px}
  .card .org{color:#cbd5e1;font-size:13px;margin-top:6px}
  .meta{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
  .badge{background:rgba(255,255,255,.08);padding:5px 10px;border-radius:999px;font-size:12px}
  .summary{color:#94a3b8;margin-top:8px;font-size:14px}
  .actions{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
  .btn-sm{font-size:13px;padding:5px 10px;border-radius:8px}
  /* modal */
  .modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.65);display:none;align-items:center;justify-content:center;z-index:1000}
  .modal-card{background:#1e293b;padding:20px;border-radius:14px;max-width:900px;width:95%;max-height:88vh;overflow:auto;box-shadow:0 20px 40px rgba(0,0,0,.7)}
  .modal-card h3{margin-top:0}
  .section-title{color:#94a3b8;margin-top:12px;font-size:13px}
</style>
</head>
<body>
  <div class="header">
    <div class="logo">SIH</div>
    <div class="title">
      <h1>SIH 2025 Problem Statements</h1>
      <p>by Shivang — Advanced Search, Category Filter, Hardware/Software Filter</p>
    </div>
  </div>

  <div class="controls">
    <input id="search" class="form-control" placeholder="Search anything...">
    <select id="category" placeholder="Filter by Category"></select>
    <select id="techType" placeholder="Filter by Tech Type">
      <option value="">All Tech Types</option>
      <option value="Hardware">Hardware</option>
      <option value="Software">Software</option>
    </select>
    <button id="btnReload" class="btn btn-primary"><i class="fa fa-rotate"></i> Reload</button>
    <input type="file" id="filePicker" accept=".xlsx" hidden>
    <button class="btn btn-outline-light" id="btnPick"><i class="fa fa-file"></i> Pick Excel</button>
  </div>

  <div id="grid"></div>
  <div id="empty" style="display:none;color:#94a3b8;margin-top:20px">No problem statements found</div>

  <!-- Modal -->
  <div id="modal" class="modal-bg">
    <div class="modal-card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="mTitle"></h3>
        <button id="mClose" class="btn btn-sm btn-outline-light"><i class="fa fa-times"></i> Close</button>
      </div>
      <div class="section-title">Organization / PS</div>
      <div id="mMeta"></div>
      <div class="section-title">Description</div>
      <div id="mDesc"></div>
      <div class="section-title">Expected Solution</div>
      <div id="mSol"></div>
      <div class="section-title">Department</div>
      <div id="mDept"></div>
      <div class="section-title">Links</div>
      <div>Dataset: <a id="mDataset" target="_blank"></a></div>
      <div>YouTube: <a id="mYoutube" target="_blank"></a></div>
      <div class="section-title">Contact</div>
      <div id="mContact"></div>
      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <button id="copyDesc" class="btn btn-sm btn-primary"><i class="fa fa-copy"></i> Copy Description</button>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
<script>
const el=id=>document.getElementById(id); let DATA=[],current=null;
function safe(x){return x||''}
function render(){
  const q=safe(el('search').value).toLowerCase();
  const cat=safe(el('category').value).toLowerCase();
  const tech=safe(el('techType').value).toLowerCase();
  const grid=el('grid'); grid.innerHTML='';
  const filtered=DATA.filter(d=>{
    if(cat && safe(d.Category).toLowerCase()!==cat) return false;
    if(tech){
      const hay=(d.Title+' '+d.Description+' '+d.Category).toLowerCase();
      const hw=['hardware','device','sensor','pcb','circuit','robot','iot'];
      const sw=['software','ai','ml','app','algorithm','cloud','vision'];
      const isHW=hw.some(k=>hay.includes(k)),isSW=sw.some(k=>hay.includes(k));
      if(tech==='hardware'&&!isHW)return false;
      if(tech==='software'&&!isSW)return false;
    }
    if(q && !Object.values(d).join(' ').toLowerCase().includes(q)) return false;
    return true;
  });
  el('empty').style.display=filtered.length?'none':'block';
  filtered.forEach(d=>{
    const c=document.createElement('div');c.className='card';
    c.innerHTML=`<div class="title">${d.Title}</div>
    <div class="org">${d.Organization} — ${d.PSNumber}</div>
    <div class="meta"><span class="badge">${d.Category}</span><span class="badge">${d.Theme}</span></div>
    <div class="summary">${d.Description.slice(0,180)}...</div>
    <div class="actions"><button class="btn btn-sm btn-outline-light openBtn">Open</button>
    <button class="btn btn-sm btn-outline-light copyBtn">Copy Desc</button></div>`;
    c.querySelector('.openBtn').onclick=()=>openModal(d);
    c.querySelector('.copyBtn').onclick=()=>navigator.clipboard.writeText(d.Description);
    grid.appendChild(c);
  });
}
function openModal(d){
  current=d;
  el('mTitle').textContent=d.Title;
  el('mMeta').textContent=`${d.Organization} • ${d.PSNumber} • ${d.ProblemStatementID}`;
  el('mDesc').textContent=d.Description;
  el('mSol').textContent=d.ExpectedSolution;
  el('mDept').textContent=d.Department||d.Organization;
  el('mDataset').textContent=d.DatasetLink;el('mDataset').href=d.DatasetLink;
  el('mYoutube').textContent=d.YoutubeLink;el('mYoutube').href=d.YoutubeLink;
  el('mContact').textContent=d.ContactInfo;
  el('modal').style.display='flex';
}
el('mClose').onclick=()=>el('modal').style.display='none';
el('copyDesc').onclick=()=>navigator.clipboard.writeText(current?.Description||'');
async function loadExcel(ab){
  const wb=XLSX.read(new Uint8Array(ab),{type:'array'});
  const sheet=wb.SheetNames[0]; const raw=XLSX.utils.sheet_to_json(wb.Sheets[sheet],{defval:''});
  DATA=raw.map(r=>({Title:r.Title,Organization:r.Organization,Category:r.Category,Theme:r.Theme,PSNumber:r.PSNumber,ProblemStatementID:r.ProblemStatementID,Department:r.Department,DatasetLink:r.DatasetLink,YoutubeLink:r.YoutubeLink,ContactInfo:r.ContactInfo,Description:r.Description,ExpectedSolution:r.ExpectedSolution}));
  render();
  // update categories
  const categories=[...new Set(DATA.map(r=>safe(r.Category)).filter(Boolean))].sort();
  const catSel=el('category'); catSel.innerHTML='<option value="">All Categories</option>';
  categories.forEach(c=>{const o=document.createElement('option');o.value=c;o.textContent=c;catSel.appendChild(o);});
  new TomSelect("#category",{persist:false,create:false,sortField:{field:"text"}});
  new TomSelect("#techType",{persist:false,create:false});
}
async function autoLoad(){try{const r=await fetch('SIH2025_problem_statements.xlsx');const ab=await r.arrayBuffer();await loadExcel(ab);}catch(e){console.warn("auto load fail",e)}}
el('btnReload').onclick=autoLoad;el('btnPick').onclick=()=>el('filePicker').click();
el('filePicker').onchange=async e=>{const f=e.target.files[0];if(f)await loadExcel(await f.arrayBuffer());};
el('search').oninput=render;el('techType').onchange=render;
autoLoad();
</script>
</body>
</html>
