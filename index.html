<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SIH 2025 Problem statements sorted by Shivang</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.2.3/morph/bootwatch.min.css" rel="stylesheet">
  <style>
    body{background:linear-gradient(180deg,#0f172a,#1e1b4b);color:#f8fafc;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;padding:20px}
    h2{margin-bottom:20px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:14px}
    .card{background:#1e293b;border-radius:12px;padding:14px;box-shadow:0 2px 10px rgba(0,0,0,0.4);transition:transform .2s}
    .card:hover{transform:translateY(-4px);box-shadow:0 4px 18px rgba(0,0,0,0.5)}
    .muted{color:#94a3b8;font-size:13px}
    .badge{background:#334155;color:#e2e8f0;border-radius:999px;padding:2px 8px;font-size:12px;margin-right:6px}
    .btn{cursor:pointer}
    #modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.65);align-items:center;justify-content:center;z-index:40}
    #modal .inner{background:#1e293b;padding:20px;border-radius:12px;width:min(900px,96%);max-height:85vh;overflow:auto;box-shadow:0 6px 20px rgba(0,0,0,0.6)}
    #modal h3{margin-top:0}
    .section{margin-top:12px}
    .section b{color:#cbd5e1}
    a{color:#60a5fa;text-decoration:none}
    a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <h2>SIH 2025 Problem statements <small style="font-weight:400;color:#94a3b8">by Shivang</small></h2>
  <div style="margin-bottom:10px">
    <input id="search" class="form-control" placeholder="Search title/org/theme/solution..." />
  </div>
  <div id="grid" class="grid"></div>
  <div id="modal"><div class="inner">
    <h3 id="mTitle"></h3>
    <div id="mMeta" class="muted"></div>
    <div class="section"><b>Description:</b><br><span id="mDesc"></span></div>
    <div class="section"><b>Expected Solution:</b><br><span id="mSol"></span></div>
    <div class="section"><b>Department:</b> <span id="mDept"></span></div>
    <div class="section"><b>Dataset:</b> <a id="mDataset" href="#" target="_blank"></a></div>
    <div class="section"><b>YouTube:</b> <a id="mYoutube" href="#" target="_blank"></a></div>
    <div class="section"><b>Contact:</b> <span id="mContact"></span></div>
    <div style="margin-top:16px"><button id="mClose" class="btn btn-light">Close</button></div>
  </div></div>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    const grid=document.getElementById('grid'),search=document.getElementById('search');
    const modal=document.getElementById('modal'),mTitle=document.getElementById('mTitle'),mMeta=document.getElementById('mMeta'),
          mDesc=document.getElementById('mDesc'),mSol=document.getElementById('mSol'),mDept=document.getElementById('mDept'),
          mDataset=document.getElementById('mDataset'),mYoutube=document.getElementById('mYoutube'),mContact=document.getElementById('mContact'),
          mClose=document.getElementById('mClose');
    let DATA=[];
    function safe(x){return x||''}
    function render(){
      grid.innerHTML='';
      const q=safe(search.value).toLowerCase();
      DATA.filter(d=>{
        return !q || Object.values(d).join(' ').toLowerCase().includes(q);
      }).forEach(d=>{
        const div=document.createElement('div');div.className='card';
        div.innerHTML=`<b>${safe(d.Title)}</b><div class="muted">${safe(d.Organization)} • ${safe(d.PSNumber)}</div>
          <div><span class="badge">${safe(d.Category)}</span><span class="badge">${safe(d.Theme)}</span></div>
          <div class="muted">${safe(d.Description).slice(0,150)}...</div>
          <button class="btn btn-sm btn-outline-light" style="margin-top:6px">Open</button>`;
        div.querySelector('button').onclick=()=>openModal(d);
        grid.appendChild(div);
      });
    }
    function openModal(d){
      mTitle.textContent=safe(d.Title);
      mMeta.textContent=[safe(d.Organization),safe(d.PSNumber),safe(d.ProblemStatementID)].filter(Boolean).join(' • ');
      mDesc.textContent=safe(d.Description);
      mSol.textContent=safe(d.ExpectedSolution);
      mDept.textContent=safe(d.Department||safe(d.Organization));
      mDataset.textContent=safe(d.DatasetLink); mDataset.href=safe(d.DatasetLink);
      mYoutube.textContent=safe(d.YoutubeLink); mYoutube.href=safe(d.YoutubeLink);
      mContact.textContent=safe(d.ContactInfo);
      modal.style.display='flex';
    }
    mClose.onclick=()=>modal.style.display='none';
    search.oninput=render;

    // AUTO-LOAD excel in same directory
    async function autoLoad(){
      try{
        const resp=await fetch('SIH2025_problem_statements.xlsx');
        const ab=await resp.arrayBuffer();
        const wb=XLSX.read(new Uint8Array(ab),{type:'array'});
        const sheet=wb.SheetNames[0]; 
        DATA=XLSX.utils.sheet_to_json(wb.Sheets[sheet],{defval:''});
        render();
      }catch(e){console.error('Excel auto-load failed',e);}
    }
    autoLoad();
  </script>
</body>
</html>
